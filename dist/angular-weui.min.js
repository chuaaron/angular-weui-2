!function(){angular.module("ng-weui-actionsheet",[]).directive("weuiActionSheet",["$document",function(e){return{restrict:"E",scope:!0,replace:!0,template:'<div class="ng-weui-action-sheet-backdrop"><div class="weui-actionsheet"><div class="weui-actionsheet__menu"><div class="weui-actionsheet__cell" ng-click="buttonClicked($index)" ng-repeat="b in buttons" ng-class="b.className" ng-bind="b.text"></div><div class="weui-actionsheet__cell destructive action-sheet-destructive" ng-if="destructiveText" ng-click="destructiveButtonClicked()" ng-bind="destructiveText"></div></div><div class="weui-actionsheet__action" ng-if="cancelText"><div class="weui-actionsheet__cell" ng-click="cancel()" ng-bind="cancelText"></div></div></div></div>',link:function(t,n){var i=function(e){27==e.which&&(t.cancel(),t.$apply())},a=function(e){e.target==n[0]&&(t.cancel(),t.$apply())};t.$on("$destroy",function(){n.remove(),e.unbind("keyup",i)}),e.bind("keyup",i),n.bind("click",a)}}}]).provider("$weuiActionSheet",function(){var e=this.defaults={buttons:[],buttonClicked:angular.noop,cancelText:"取消",cancel:angular.noop,cancelOnStateChange:!0};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(t,n,i,a,o,l,c,r,s,u){var d=angular.element,p=d(document.body),g=angular.extend,v=angular.noop,m=angular.copy,f={show:function(t){var n=l.$new(!0);g(n,m(e),t||{});var a=n.element=i("<weui-action-sheet></weui-action-sheet>")(n),o=d(a[0].querySelector(".weui-actionsheet")),c=n.cancelOnStateChange?l.$on("$stateChangeSuccess",function(){n.cancel()}):v;return p.append(a),n.showSheet=function(e){n.removed||(a[0].offsetWidth,a.addClass("active"),o.addClass("weui-actionsheet_toggle"))},n.removeSheet=function(e){n.removed||(n.removed=!0,o.removeClass("weui-actionsheet_toggle"),a.removeClass("active"),c(),a.on("transitionend",function(){a.remove(),n.cancel.$scope=a=null,(e||v)(t.buttons)}))},n.buttonClicked=function(e){t.buttonClicked(e,t.buttons[e])===!0&&n.removeSheet()},n.destructiveButtonClicked=function(){t.destructiveButtonClicked()===!0&&n.removeSheet()},n.cancel=function(){n.removeSheet(t.cancel)},n.showSheet(),n.cancel.$scope=n,n.cancel}};return f}],this.setDefaults=function(t){angular.extend(e,t)}})}(),function(){angular.module("ng-weui-backdrop",[]).provider("$weuiBackdrop",function(){this.$get=["$document","$timeout","$$rAF","$rootScope",function(e,t,n,i){var a=angular.element,o=a(document.body),l=(angular.extend,angular.noop,angular.copy,{backdropHolds:0,_el:a('<div class="weui-mask hidden"></div>'),_init:function(){o.append(l._el)}}),c={getElement:function(){return l._el},retain:function(){l.backdropHolds++,1===l.backdropHolds&&(l._el.addClass("visible"),i.$broadcast("backdrop.shown"),n(function(){l.backdropHolds>=1&&l._el.addClass("active")}))},release:function(){1===l.backdropHolds&&(l._el.removeClass("active"),i.$broadcast("backdrop.hidden"),t(function(){0===l.backdropHolds&&l._el.removeClass("visible")},400,!1)),l.backdropHolds=Math.max(0,l.backdropHolds-1)}};return l._init(),c}]})}(),function(){angular.module("ng-weui-dialog",[]).directive("weuiDialog",["$document",function(e){return{restrict:"E",scope:!0,replace:!0,template:'<div class="ng-weui-dialog-wrapper hidden"><div class="weui-dialog"><div class="weui-dialog__hd"><strong class="weui-dialog__title" ng-bind="title"></strong></div><div class="weui-dialog__bd" ng-bind="text"></div><div class="weui-dialog__ft"><a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" ng-if="cancelText" ng-click="cancel()" ng-bind="cancelText"></a><a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" ng-click="confirm()" ng-bind="confirmText"></a></div></div></div>',link:function(t,n){var i=function(e){27==e.which&&(t.cancel(),t.$apply())};t.$on("$destroy",function(){n.remove(),e.unbind("keyup",i)}),e.bind("keyup",i)}}}]).provider("$weuiDialog",function(){var e=this.defaults={className:void 0,title:void 0,text:void 0,bodyClassName:"ng-weui-dialog-open",cancelText:"取消",cancel:angular.noop,confirmText:"确定",confirm:angular.noop};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$weuiBackdrop",function(t,n,i,a,o,l,c,r,s,u){var d=angular.element,p=d(document.body),g=angular.extend,v=angular.noop,m=angular.copy,f={open:function(t){var n=l.$new(!0);g(n,m(e),t||{});var a=n.element=i("<weui-dialog></weui-dialog>")(n);return p.addClass(n.bodyClassName).append(a),n.showDialog=function(e){if(!n.removed){u.retain();var t=u.getElement();t.addClass("backdrop-dialog"),t.off().on("click",function(e){t.hasClass("backdrop-dialog")&&n.cancel()}),a.addClass("visible"),a[0].offsetWidth,a.addClass("active")}},n.removeDialog=function(e){n.removed||(n.removed=!0,u.release(),u.getElement().removeClass("backdrop-dialog"),a.removeClass("active"),a.on("transitionend",function(){a.remove(),n.$destroy(),n.cancel.$scope=a=null,(e||v)()}))},n.cancel=function(){n.removeDialog(t.cancel)},n.confirm=function(){n.removeDialog(t.confirm)},n.showDialog(),n.cancel.$scope=n,n.cancel}};return f}],this.setDefaults=function(t){angular.extend(e,t)}})}(),function(){angular.module("ng-weui-fileUpload",[]).factory("$weuiFileReader",["$q",function(e){var t=function(e,t,n){return function(){n.$apply(function(){t.resolve(e.result)})}},n=function(e,t,n){return function(){n.$apply(function(){t.reject(e.result)})}},i=function(e,i){var a=new FileReader;return a.onload=t(a,e,i),a.onerror=n(a,e,i),a},a=function(t,n){var a=e.defer(),o=i(a,n);return o.readAsDataURL(t),a.promise};return{readAsDataUrl:a}}]).provider("$weuiFileOptimization",function(){var e=this.defaults={maxWidth:640,maxHeight:640};this.$get=["$q","$http",function(t,n){var i={dataURItoBlob:function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(t.length),a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([i],{type:n})},resizeFile:function(n,a){var o=t.defer(),l=document.createElement("img"),a=a||{},c=angular.extend(angular.copy(e),a);try{var r=new FileReader;r.onload=function(e){l.src=e.target.result;var t=document.createElement("canvas"),n=t.getContext("2d");n.drawImage(l,0,0);var a=c.maxWidth,r=c.maxHeight,s=l.width,u=l.height;s>u?s>a&&(u*=a/s,s=a):u>r&&(s*=r/u,u=r),t.width=s,t.height=u;var n=t.getContext("2d");n.drawImage(l,0,0,s,u);var d=t.toDataURL("image/jpeg"),p={};p.base64=d,p.blob=i.dataURItoBlob(d),o.resolve(p)},r.readAsDataURL(n)}catch(s){o.resolve(s)}return o.promise}};return{resizeFile:i.resizeFile}}],this.setDefaults=function(t){angular.extend(e,t)}}).directive("weuiFileModel",["$parse","$compile",function(e,t){return{restrict:"A",link:function(n,i,a,o){function l(e){var i=t(e.clone().val(""))(n);e.after(i),e.remove()}var c=e(a.weuiFileModel),r=c.assign;i.bind("change",function(e){n.$apply(function(){r(n,i[0].files[0])}),n.file=(e.srcElement||e.target).files[0],n.$apply(a.fileFn),l(i)})}}}])}(),function(){angular.module("ng-weui-gallery",[]).directive("weuiGallery",["$document",function(e){return{restrict:"E",scope:!0,replace:!0,template:'<div class="weui-gallery"><span class="weui-gallery__img" style="background-image:url({{url}})" ng-click="cancel()"></span><div class="weui-gallery__opr"><a href="javascript:" class="weui-gallery__del" ng-click="delete()"><i class="weui-icon-delete weui-icon_gallery-delete"></i></a></div></div>',link:function(e,t){}}}]).provider("$weuiGallery",function(){var e=this.defaults={url:void 0,cancel:angular.noop,"delete":angular.noop};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(t,n,i,a,o,l,c,r,s,u){var d=angular.element,p=d(document.body),g=angular.extend,v=angular.noop,m=angular.copy,f={show:function(t){var n=l.$new(!0);g(n,m(e),t||{});var a=n.element=i("<weui-gallery></weui-gallery>")(n);return p.append(a),n.show=function(e){n.removed||(a[0].offsetWidth,a.addClass("weui-gallery_toggle"))},n.remove=function(e){n.removed||(n.removed=!0,a.removeClass("weui-gallery_toggle"),a.on("transitionend",function(){a.remove(),n.cancel.$scope=a=null,(e||v)(t.url)}))},n.cancel=function(){n.remove(t.cancel)},n["delete"]=function(){n.remove(t["delete"])},n.show(),n.cancel.$scope=n,n.cancel}};return f}],this.setDefaults=function(t){angular.extend(e,t)}})}(),function(){angular.module("ng-weui-loading",[]).directive("weuiLoading",["$document",function(e){return{restrict:"E",scope:!0,replace:!0,template:'<div class="ng-weui-loading-wrapper hidden"><div class="weui-toast"><i class="weui-loading weui-icon_toast"></i><p class="weui-toast__content"></p></div></div>',link:function(e,t){}}}]).provider("$weuiLoading",function(){var e=this.defaults={template:"数据加载中",templateUrl:null,noBackdrop:!0,hideOnStateChange:!1};this.$get=["$document","$weuiTemplateLoader","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$weuiBackdrop",function(t,n,i,a,o,l,c,r,s,u){var d=angular.element,p=d(document.body),g=angular.extend,v=(angular.noop,angular.copy),m={instance:null,getLoader:function(){return m.instance||(m.instance=n.compile({template:"<weui-loading></weui-loading>",appendTo:p}).then(function(e){return e.show=function(t){var o=t.templateUrl?n.load(t.templateUrl):a.when(t.template||t.content||"");e.scope=t.scope||e.scope,e.isShown||(e.hasBackdrop=!t.noBackdrop,e.hasBackdrop&&(u.retain(),u.getElement().addClass("backdrop-loading"))),o.then(function(t){if(t){var n=d(e.element[0].querySelector(".weui-toast__content"));n.html(t),i(n.contents())(e.scope)}e.isShown&&(e.element.addClass("visible"),e.element[0].offsetWidth,e.element.addClass("active"),p.addClass("ng-weui-loading-active"))}),e.isShown=!0},e.hide=function(){e.isShown&&(e.hasBackdrop&&(u.release(),u.getElement().removeClass("backdrop-loading")),e.element.removeClass("active"),p.removeClass("ng-weui-loading-active"),e.element.removeClass("visible")),e.isShown=!1;var t=d(e.element[0].querySelector(".weui-toast__content"));t.html("")},e})),m.instance}},f={show:function(t){var n=g(v(e),t);return n.hideOnStateChange&&(l.$on("$stateChangeSuccess",f.hide),l.$on("$stateChangeError",f.hide)),m.getLoader().then(function(e){return e.show(n)})},hide:function(){return m.getLoader().then(function(e){return e.hide()})}};return f}],this.setDefaults=function(t){angular.extend(e,t)}})}(),function(){angular.module("ng-weui-msg",[]).directive("weuiMsg",function(){return{scope:{type:"@",title:"@",desc:"@",onSuccess:"&",onWarn:"&"},restrict:"E",template:'<div class="weui-msg"><div class="weui-msg__icon-area"><i class="weui-icon_msg" ng-class="cls"></i></div><div class="weui-msg__text-area"><h2 class="weui-msg__title" ng-bind="title"></h2><p class="weui-msg__desc" ng-bind="desc"></p></div><div class="weui-msg__opr-area"><p class="weui-btn-area"><a href="javascript:void(0);" class="weui-btn weui-btn_primary" ng-click="onSuccess()">确定</a><a href="javascript:void(0);" class="weui-btn weui-btn_default" ng-click="onWarn()">取消</a></p></div><div class="weui-msg__extra-area" ng-transclude></div></div>',replace:!0,transclude:!0,link:function(e,t,n,i){e.cls="warn"===n.type?{"weui-icon-warn":!0}:{"weui-icon-success":!0}}}})}(),function(){angular.module("ng-weui-panel",[]).directive("weuiPanel",function(){return{scope:{title:"@",viewMore:"&"},restrict:"AE",template:'<div class="weui-panel weui-panel_access"><div class="weui-panel__hd" ng-if="!!title" ng-bind="title"></div><div class="weui-panel__bd" ng-transclude></div><div class="weui-panel__ft"><a href="javascript:void(0);" class="weui-cell weui-cell_access weui-cell_link" ng-if="show" ng-click="viewMore()"><div class="weui-cell__bd">查看更多</div><span class="weui-cell__ft"></span></a></div></div>',replace:!0,transclude:!0,link:function(e,t,n,i){e.show=!!n.viewMore&&angular.isFunction(e.viewMore)}}}).directive("panelAppmsg",function(){return{scope:{image:"=",title:"=",desc:"="},require:"^?weuiPanel",restrict:"E",template:'<a href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg"><div class="weui-media-box__hd" ng-if="!!image"><img class="weui-media-box__thumb" ng-src="{{image}}" alt=""></div><div class="weui-media-box__bd"><h4 class="weui-media-box__title" ng-bind="title"></h4><p class="weui-media-box__desc" ng-bind="desc"></p></div></a>',replace:!0}}).directive("panelText",function(){return{scope:{image:"=",title:"=",desc:"="},require:"^?weuiPanel",restrict:"E",template:'<div class="weui-media-box weui-media-box_text"><h4 class="weui-media-box__title" ng-bind="title"></h4><p class="weui-media-box__desc" ng-bind="desc"></p><div ng-transclude></div></div>',replace:!0,transclude:!0}}).directive("weuiPanelSm",function(){return{scope:{title:"@"},restrict:"AE",template:'<div class="weui-panel"><div class="weui-panel__hd" ng-if="!!title" ng-bind="title"></div><div class="weui-panel__bd"><div class="weui-media-box weui-media-box_small-appmsg"><div class="weui-cells" ng-transclude></div></div></div></div>',replace:!0,transclude:!0}}).directive("panelAppmsgSm",function(){return{scope:{image:"=",title:"="},require:"^?weuiPanelSm",restrict:"E",template:'<a class="weui-cell weui-cell_access" href="javascript:;"><div class="weui-cell__hd" ng-if="!!image"><img ng-src="{{image}}" alt="" style="width:20px;margin-right:5px;display:block"></div><div class="weui-cell__bd weui-cell_primary"><p ng-bind="title"></p></div><span class="weui-cell__ft"></span></a>',replace:!0}})}(),function(){angular.module("ng-weui-popup",[]).directive("weuiPopup",["$document",function(e){return{restrict:"E",scope:!0,replace:!0,template:'<div class="ng-weui-dialog-wrapper hidden" ng-class="className"><div class="weui-dialog"><div class="weui-dialog__hd"><strong class="weui-dialog__title" ng-bind="title"></strong></div><div class="weui-dialog__bd"></div><div class="weui-dialog__ft" ng-show="buttons.length"><a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" ng-repeat="button in buttons" ng-click="$buttonTapped(button, $event)" ng-class="button.type || \'button-default\'" ng-bind="button.text"></a></div></div></div>',link:function(t,n){var i=function(e){if(27==e.which){var i=n.data("$ngWeuiPopup");i.responseDeferred.promise.close(),t.$apply()}};t.$on("$destroy",function(){n.remove(),e.unbind("keyup",i)}),e.bind("keyup",i)}}}]).provider("$weuiPopup",function(){var e=this.defaults={cancelText:"取消",cancelType:"weui-dialog__btn_default",okText:"确定",okType:"weui-dialog__btn_primary"};this.$get=["$q","$timeout","$rootScope","$compile","$weuiTemplateLoader","$weuiBackdrop",function(t,n,i,a,o,l){function c(e){e=v({scope:null,title:"",buttons:[]},e||{});var l={};l.scope=(e.scope||i).$new(),l.element=p("<weui-popup></weui-popup>"),l.responseDeferred=t.defer(),a(l.element)(l.scope),l.element.data("$ngWeuiPopup",l),v(l.scope,{title:e.title,buttons:e.buttons,className:e.className,$buttonTapped:function(e,t){var n=(e.onTap||m).apply(l,[t]);t=t.originalEvent||t,t.defaultPrevented||l.responseDeferred.resolve(n)}});var c=e.templateUrl?o.load(e.templateUrl):e.template||e.content||"";return t.when(c).then(function(e){var t=p(l.element[0].querySelector(".weui-dialog__bd"));e?(t.html(e),a(t.contents())(l.scope)):t.remove()}),l.show=function(){l.isShown||l.removed||(l.isShown=!0,l.isShown&&(g.append(l.element),l.element[0].offsetWidth,l.element.addClass("visible active"),h.focusInput(l.element)))},l.hide=function(e){return e=e||m,l.isShown?(l.isShown=!1,l.element.removeClass("active"),void n(e,250,!1)):e()},l.remove=function(){l.removed||(l.hide(function(){l.element.remove(),l.scope.$destroy()}),l.removed=!0)},l}function r(e){function t(){w.push(i),n(i.show,a,!1),i.responseDeferred.promise.then(function(e){var t=w.indexOf(i);return t!==-1&&w.splice(t,1),i.remove(),w.length>0?w[w.length-1].show():(l.release(),l.getElement().removeClass("backdrop-popup"),n(function(){w.length||g.removeClass("ng-weui-popup-open")},400,!1)),e})}var i=b._createPopup(e),a=0;if(w.length>0)a=f.stackPushDelay,n(w[w.length-1].hide,a,!1);else{g.addClass("ng-weui-popup-open"),l.retain();var o=l.getElement();o.addClass("backdrop-popup"),o.off().on("click",function(e){o.hasClass("backdrop-popup")&&i.responseDeferred.promise.close()})}return i.responseDeferred.promise.close=function(e){i.removed||i.responseDeferred.resolve(e)},i.responseDeferred.notify({close:i.responseDeferred.close}),t(),i.responseDeferred.promise}function s(t){return r(v({buttons:[{text:t.okText||e.okText,type:t.okType||e.okType,onTap:function(){return!0}}]},t||{}))}function u(t){return r(v({buttons:[{text:t.cancelText||e.cancelText,type:t.cancelType||e.cancelType,onTap:function(){return!1}},{text:t.okText||e.okText,type:t.okType||e.okType,onTap:function(){return!0}}]},t||{}))}function d(t){var n=i.$new(!0);n.data={},n.data.fieldtype=t.inputType?t.inputType:"text",n.data.response=t.defaultText?t.defaultText:"",n.data.placeholder=t.inputPlaceholder?t.inputPlaceholder:"",n.data.maxlength=t.maxLength?parseInt(t.maxLength):"";var a="";return t.template&&/<[a-z][\s\S]*>/i.test(t.template)===!1&&(a="<span>"+t.template+"</span>",delete t.template),r(v({template:a+'<input class="weui-input" ng-model="data.response" type="{{ data.fieldtype }}"maxlength="{{ data.maxlength }}"placeholder="{{ data.placeholder }}">',scope:n,buttons:[{text:t.cancelText||e.cancelText,type:t.cancelType||e.cancelType,onTap:function(){}},{text:t.okText||e.okText,type:t.okType||e.okType,onTap:function(){return n.data.response||""}}]},t||{}))}var p=angular.element,g=p(document.body),v=angular.extend,m=angular.noop,f=(angular.copy,{stackPushDelay:75}),w=[],h={focusInput:function(e){var t=e[0].querySelector("[autofocus]");t&&t.focus()}},b={show:r,alert:s,confirm:u,prompt:d,_createPopup:c,_popupStack:w};return b}],this.setDefaults=function(t){angular.extend(e,t)}})}(),function(){angular.module("ng-weui-templateLoader",[]).factory("$weuiTemplateLoader",["$compile","$controller","$http","$q","$rootScope","$templateCache",function(e,t,n,i,a,o){function l(e){return n.get(e,{cache:o}).then(function(e){return e.data&&e.data.trim()})}function c(n){n=angular.extend({template:"",templateUrl:"",scope:null,controller:null,locals:{},appendTo:null},n||{});var o=n.templateUrl?this.load(n.templateUrl):i.when(n.template);return o.then(function(i){var o,l=n.scope||a.$new(),c=angular.element("<div>").html(i).contents();return n.controller&&(o=t(n.controller,angular.extend(n.locals,{$scope:l})),c.children().data("$ngControllerController",o)),n.appendTo&&angular.element(n.appendTo).append(c),e(c)(l),{element:c,scope:l}})}return{load:l,compile:c}}])}(),function(){angular.module("ng-weui-toast",[]).directive("weuiToast",["$document",function(e){return{restrict:"E",scope:!0,replace:!0,template:'<div class="ng-weui-toast-wrapper hidden"><div class="weui-toast"><i class="weui-icon-success-no-circle weui-icon_toast"></i><p class="weui-toast__content" ng-bind="text"></p></div></div>',link:function(e,t){}}}]).provider("$weuiToast",function(){var e=this.defaults={type:"default",timer:1500,text:"已完成",noBackdrop:!0,success:angular.noop};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$weuiBackdrop",function(t,n,i,a,o,l,c,r,s,u){var d=angular.element,p=d(document.body),g=angular.extend,v=angular.noop,m=angular.copy,f={show:function(t){var n=l.$new(!0);g(n,m(e),t||{});var a=n.element=i("<weui-toast></weui-toast>")(n);"forbidden"==n.type&&a.addClass("ng-weui-toast-forbidden"),p.append(a),n.noBackdrop||(u.retain(),u.getElement().addClass("backdrop-toast")),a.addClass("visible"),a[0].offsetWidth,a.addClass("active"),n.remove=function(e){c(function(){n.noBackdrop||(u.release(),u.getElement().removeClass("backdrop-toast")),a.removeClass("visible active"),a.remove(),n.$destroy(),(e||v)()},n.timer)},n.cancel=function(){n.remove(t.success)},n.cancel()}};return f}],this.setDefaults=function(t){angular.extend(e,t)}})}(),function(){var e=window.ngWeui||(window.ngWeui={}),t=null!=navigator.userAgent.match(/iPad/i),n=null!=navigator.userAgent.match(/iPhone/i),i=null!=navigator.userAgent.match(/Android/i),a=null!=navigator.userAgent.match(/webOS/i),o=null!=navigator.userAgent.match(/micromessenger/i);e.isIpad=t,e.isIPhone=n,e.isAndroid=i,e.isWebOS=a,e.isWechat=o,e.isMobile=t||n||i||a,e.isPC=!e.isMobile,e.version="v0.0.1",angular.module("ng-weui",["ng-weui-actionsheet","ng-weui-backdrop","ng-weui-dialog","ng-weui-fileUpload","ng-weui-gallery","ng-weui-loading","ng-weui-msg","ng-weui-panel","ng-weui-popup","ng-weui-templateLoader","ng-weui-toast"])}();